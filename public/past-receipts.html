<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Past Receipts - Lakastah Makan Cafe</title>
<link rel="stylesheet" href="styles.css">
<link rel="manifest" href="manifest.json">

<style>
/* Container & Phone Frame */
.container { max-width: 400px; margin: auto; }
.phone-frame {
    width: 400px;
    height: 780px;
    border-radius: 30px;
    border: 1px solid #ccc;
    background: #f5f5f5;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}
.content.with-nav { flex: 1; padding: 12px; overflow-y: auto; }

/* Header */
.page-header {
    display: flex;
    align-items: center;
    padding: 12px;
    font-size: 20px;
    font-weight: bold;
    gap: 10px;
    background: #fff;
    border-radius: 12px 12px 0 0;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.back-btn { font-size: 24px; cursor: pointer; }

/* Receipt List */
.receipt-list { margin-top: 12px; display: flex; flex-direction: column; gap: 12px; }
.receipt-card {
    background: #fff;
    padding: 12px;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: 0.2s;
}
.receipt-card:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

.nav-item { text-align: center; color: #777; font-size: 12px; text-decoration: none; }
.nav-item.active { color: #ff7a00; }
.nav-icon { display: block; font-size: 20px; }
.nav-label { display: block; font-size: 10px; }
</style>
</head>
<body>
<div class="container">
    <div class="phone-frame">
        <div class="content with-nav">
            <div class="page-header">
                <span class="back-btn" onclick="history.back()">‚Üê Back</span>
                Past Receipts
            </div>

            <div id="receiptList" class="receipt-list"></div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="home.html" class="nav-item"><span class="nav-icon">üè†</span><span class="nav-label">Home</span></a>
            <a href="deals.html" class="nav-item"><span class="nav-icon">üè∑Ô∏è</span><span class="nav-label">Deals</span></a>
            <a href="meals.html" class="nav-item"><span class="nav-icon">üçΩÔ∏è</span><span class="nav-label">Menu</span></a>
            <a href="cart.html" class="nav-item"><span class="nav-icon">üõí</span><span class="nav-label">Cart</span></a>
            <a href="profile.html" class="nav-item active"><span class="nav-icon">üë§</span><span class="nav-label">You</span></a>
        </nav>
    </div>
</div>
<script>
    // Protect page: only logged-in users allowed
    const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

    if (!loggedInUser) {
        // Not logged in ‚Üí redirect
        window.location.href = "login.html";
    }
</script>


<script>
// Fetch all past receipts from localStorage
let pastReceipts = JSON.parse(localStorage.getItem('pastReceipts')) || [];
const receiptListEl = document.getElementById('receiptList');

function renderReceipts() {
    receiptListEl.innerHTML = '';

    if (pastReceipts.length === 0) {
        receiptListEl.innerHTML = '<p style="text-align:center; color:#777;">No past receipts found.</p>';
        return;
    }

    pastReceipts.forEach((receipt, index) => {
        const card = document.createElement('div');
        card.className = 'receipt-card';
        const date = new Date(receipt.date).toLocaleString();
        card.innerHTML = `
            <span>Receipt #${index + 1}</span>
            <span>$${receipt.total.toFixed(2)}</span>
        `;
        card.title = `Click to view details from ${date}`;
        card.addEventListener('click', () => {
            localStorage.setItem('currentReceipt', JSON.stringify(receipt));
            window.location.href = 'receipt.html';
        });
        receiptListEl.appendChild(card);
    });
}

renderReceipts();
</script>
</body>
</html>
